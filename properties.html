<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Heritage Trust - South Carolina</title>

    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/7823874/6975392/css/fonts.css" />

    <script src="https://use.fontawesome.com/78d5382ace.js"></script>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/heritage-trust.css" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="" />
    

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg text-white fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">South Carolina Heritage Trust</a>
            <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="properties.html">Properties</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownAbout" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About</a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownAbout">
                            <a class="dropdown-item" href="history.html">History</a>
                            <a class="dropdown-item" href="staff.html">Staff</a>
                            <a class="dropdown-item" href="parker-annex.html">Archaeology Center</a>
                            <a class="dropdown-item" href="http://www.dnr.sc.gov/admin/committees/heritage.html" target="_blank">Advisory Board</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownInvolved" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Get Involved</a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownInvolved">
                            <a class="dropdown-item" href="volunteer.html">Volunteer</a>
                            <a class="dropdown-item" href="internships.html">Internships</a>
                            <a class="dropdown-item" href="events.html">Events &amp; Workshops</a>
                            <!--<a class="dropdown-item" href="donate.html">Donate</a>-->
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownResources" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources</a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownResources">
                            <a class="dropdown-item" href="education.html">For Educators</a>
                            <a class="dropdown-item" href="researchers.html">For Researchers</a>
                            <a class="dropdown-item" href="laws.html">Laws</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Header - set the background image for the header in the line below -->
    <header class="py-5 bg-image-full inner-page-img" style="background: url('images/botanybaycover.jpg') center center no-repeat;">
        <img class="img-fluid d-block mx-auto inner-logo" src="images/hplogo_white_trans.png" alt="">
    </header>

    <!-- Content section -->
    <section class="py-5">
        <div class="container">
            <h2 class="red-header">Find a Heritage Preserve<i class="fa fa-map-marker" aria-hidden="true"></i></h2>
            <p class="lead">There are Heritage Preserves in every corner of the state.</p>

            <div class="section row" id="map-search">
                <div class="col-md-3">
                    <button class="btn" id="cul">Cultural Preserves<i class="fa fa-check-square-o" aria-hidden="true"></i></button>
                    <img class="map-icon" src="images/arrowhead.svg">
                </div>
                <div class="col-md-3">
                    <button class="btn" id="nat">Natural Preserves<i class="fa fa-check-square-o" aria-hidden="true"></i></button>
                    <img class="map-icon" src="images/leaf.svg">
                </div>
            </div>

            <div id="map">
            </div>

        </div>
    </section>


    <!-- Footer -->
    <footer class="py-5">
        <div class="container">
            <div class="row" id="footer-content">
                <div class="col-md-4">
                    <address>
                        <p class="m-0">SC Department of Natural Resources</p>
                        <p class="m-0">1000 Assembly Street</p>
                        <p class="m-0">Columbia, SC 29201</p>
                    </address>
                </div>

                <div class="col-md-4 order-8 order-md-4" id="logos">
                    <img src="images/logos.png" alt="scdnr and heritage trust logos" />
                    <p class="mt-2" id="copyright">Copyright &copy; 2017<br>                         Cover photo: Ken Lane; <a href="https://creativecommons.org/licenses/by-nc/2.0/" target="_blank">CC BY-NC 2.0</a></p>
                </div>

                <div class="col-md-4 order-4 order-md-8">
                    <address>
                        <p class="m-0">Parker Annex Archaeology Center</p>
                        <p class="m-0">2025 Barnwell Street</p>
                        <p class="m-0">Columbia, SC 29201</p>
                    </address>
                </div>
            </div>

        </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
    <script src="https://unpkg.com/esri-leaflet@2.0.4/dist/esri-leaflet.js"></script>
    
    <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.8/dist/esri-leaflet-geocoder.css">
    <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.8"></script>

    <script>
        var map = L.map('map', {
            scrollWheelZoom: false,
            zoomControl:false
        }).setView([33.6, -81.0], 7);

        var Esri_NatGeoWorldMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC',
            maxZoom: 16
        }).addTo(map);
            
        
        
        var natural =  L.icon({
                iconUrl: 'images/leaf.svg',
                iconSize: [30, 30]
            }),
            cultural = L.icon({
                iconUrl: 'images/arrowhead.svg',
                iconSize: [30, 30]
            });
        
        var dataurl = "https://services.arcgis.com/acgZYxoN5Oj8pDLa/arcgis/rest/services/DNRHeritagePreserves/FeatureServer/0"
        
        var nhp = L.esri.featureLayer({
            url:dataurl,
            where: "hp_type = 'natural'",
            pointToLayer: function (geojson, latlng){
                return L.marker(latlng, {
                    icon:natural
                });
            }
        }).addTo(map);
        
        var chp = L.esri.featureLayer({
            url:dataurl,
            where: "hp_type = 'cultural'",
            pointToLayer: function (geojson, latlng){
                return L.marker(latlng, {
                    icon:cultural,
                    zIndexOffset: 500
                });
            }
        }).addTo(map);
        
        var popupTemplate = '<div class="popup"><h6 class="red-header">{Proprty_NA}</h6><a href="https://www2.dnr.sc.gov/ManagedLands/ManagedLand/ManagedLand/{MANPROPID}" target="_blank">Property Details</a><br><a href="https://www.google.com/maps/?q={Y},{X}" target="blank_">Directions</a></div>'
        
        nhp.bindPopup(function (layer){
            return L.Util.template(popupTemplate, layer.feature.properties);
        });
        
        chp.bindPopup(function(layer){
            return L.Util.template(popupTemplate, layer.feature.properties);
        });
        
        //combine these into one function
        $('#cul').click(function() {
            if (map.hasLayer(chp)) {
                map.removeLayer(chp);
            } else {
                map.addLayer(chp)
            }
            $("i", this).toggleClass('fa-square-o fa-square-check-o');
        });

        $('#nat').click(function() {
            if (map.hasLayer(nhp)) {
                map.removeLayer(nhp);
            } else {
                map.addLayer(nhp)
            }
            $("i", this).toggleClass('fa-square-o fa-square-check-o');
        });
        
        //search search the map for a preserve or addresses
       var propSearch = L.esri.Geocoding.featureLayerProvider({
            url: dataurl,
            searchFields: ['Proprty_NA'],
            label: 'Preserve Name',
            maxResults:4
        });

        var agol = L.esri.Geocoding.arcgisOnlineProvider({
            maxResults:2
        });

        var searchControl = L.esri.Geocoding.geosearch({
            position: 'topright',
            expanded:true,
            collapseAfterResult:false,
            providers: [propSearch, agol],
            title: "Preserve Name or Place Search",
            placeholder: "Preserve name or address...",
            searchBounds: [[35.42,-83.87],[31.33,-77.7]]
        }).addTo(map);
        
        L.control.zoom({position:'topright'}).addTo(map);
    </script>

</body>

</html>